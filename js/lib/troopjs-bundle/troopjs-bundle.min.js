/*!
* TroopJS Bundle - 2.0.0-0-g182e547-dirty
* http://troopjs.com/
* Copyright (c) 2013 Mikael Karon <mikael@karon.se>
* Licensed MIT
*/
define("troopjs-utils/unique",[],function(){var t="length";return function(n){var r,i=this,s,o,u,a=i[t];if(n)e:for(s=u=0;s<a;s++){r=i[s];for(o=0;o<s;o++)if(n.call(i,r,[o])===!0)continue e;i[u++]=r}else t:for(s=u=0;s<a;s++){r=i[s];for(o=0;o<s;o++)if(r===i[o])continue t;i[u++]=r}return i[t]=u}}),define("poly/lib/_base",["require","exports","module"],function(e,t,n){var r;r={}.toString,t.isFunction=function(e){return typeof e=="function"},t.isString=function(e){return r.call(e)=="[object String]"},t.toString=function(e){return r.apply(e)},t.createCaster=function(e,t){return function(r){if(r==null)throw new TypeError(t+" method called on null or undefined");return e(r)}}}),define("poly/object",["./lib/_base"],function(e){function p(e){return function(){throw new Error("poly/object: "+e+" is not safely supported.")}}function d(n){var r=u[n];return e.isFunction(r)?r(t):r in t}function v(){}function m(e,t){return e.hasOwnProperty(t)}function g(e){var t=[];for(var n in e)m(e,n)&&t.push(n);return t}function y(e){var t;typeof e=="function"?t=e:t=function(){return e};for(var n in a)Object[n]=t(n)?p(n):a[n]}function b(e){if(typeof e!="object")throw new TypeError("Object.getPrototypeOf called on non-object")}var t,n,r,i,s,o,u,a,f,l,c="hasOwnProperty",h;t=Object,n=t.prototype,r=typeof {}.__proto__=="object",i=function(){for(var e in{valueOf:1})return!1;return!0}(),s=r?function(e){return b(e),e.__proto__}:function(e){return b(e),l&&e[l](f)?e[l](f.proto):e.constructor?e.constructor.prototype:n},o=i?function(e){return function(t){var n=g(t),r=0,i;while(i=e[r++])m(t,i)&&n.push(i);return n}}(["constructor",c,"isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"]):g,u={"object-create":"create","object-freeze":"freeze","object-isfrozen":"isFrozen","object-seal":"seal","object-issealed":"isSealed","object-getprototypeof":"getPrototypeOf","object-keys":"keys","object-getownpropertynames":"getOwnPropertyNames","object-defineproperty":function(t){try{return"defineProperty"in t&&"sentinel"in Object.defineProperty({},"sentinel",{})}catch(n){}},"object-defineproperties":"defineProperties","object-isextensible":"isExtensible","object-preventextensions":"preventExtensions","object-getownpropertydescriptor":function(t){try{return"getOwnPropertyDescriptor"in t&&Object.getOwnPropertyDescriptor({sentinel:0}).value===0}catch(n){}}},a={},f={proto:{}},l=!d("object-getprototypeof")&&!r&&i&&c,l&&function(e){n[c]=function(t){return t==l?!1:e.call(this,t)}}(n[c]),d("object-create")||(Object.create=a.create=function(t,n){var r;if(typeof t!="object")throw new TypeError("prototype is not of type Object or Null.");v.prototype=t,r=new v,v.prototype=null;if(l){var i=r[l];r[l]=function(e){return e==f?!0:e==f.proto?t:i.call(this,e)}}return arguments.length>1&&Object.defineProperties(r,n),r}),d("object-freeze")||(Object.freeze=a.freeze=function(t){return t}),d("object-isfrozen")||(Object.isFrozen=a.isFrozen=function(t){return!1}),d("object-seal")||(Object.seal=a.seal=function(t){return t}),d("object-issealed")||(Object.isSealed=a.isSealed=function(t){return!1}),d("object-getprototypeof")||(Object.getPrototypeOf=a.getPrototypeOf=s),d("object-keys")||(Object.keys=o),d("object-getownpropertynames")||(Object.getOwnPropertyNames=a.getOwnPropertyNames=function(t){return o(t)});if(!d("object-defineproperty")||!d("object-defineproperties"))Object.defineProperty=a.defineProperty=function(t,n,r){return t[n]=r&&r.value,t};if(!d("object-defineproperties")||!d("object-create"))Object.defineProperties=a.defineProperties=function(t,n){var r,i;r=o(n);while(i=r.pop())Object.defineProperty(t,i,n[i]);return t};return d("object-isextensible")||(Object.isExtensible=a.isExtensible=function(t){var n="_poly_";try{while(n in t)n+="_";return t[n]=1,m(t,n)}catch(r){return!1}finally{try{delete t[n]}catch(r){}}}),d("object-preventextensions")||(Object.preventExtensions=a.preventExtensions=function(t){return t}),d("object-getownpropertydescriptor")||(Object.getOwnPropertyDescriptor=a.getOwnPropertyDescriptor=function(t,n){return m(t,n)?{value:t[n],enumerable:!0,configurable:!0,writable:!0}:h}),{failIfShimmed:y}}),define("troopjs-core/component/factory",["troopjs-utils/unique","poly/object"],function(t){function y(){var e=[this];return r.apply(e,arguments),b.apply(null,e)}function b(){function H(){var e=this instanceof H?this:Object.create(D),t=arguments,n;Object.defineProperty(e,f,{value:H});for(n=0;n<T;n++)t=x[n].apply(e,t)||t;return e}var e,n=[],b,w,E=arguments,S=E[u],x=[],T,N,C,k,L,A,O,M,_,D={},P={};for(L=0;L<S;L++){w=E[L];if(typeof w===s){l in w?r.apply(x,w[l]):r.call(x,w),c in w&&i.apply(n,w[c]);if(w===w[o][f])continue;w=w[o]}C=Object.getOwnPropertyNames(w);for(A=0,k=C[u];A<k;A++)N=C[A],(_=g.exec(N))?(e={},e[h]=O=_[1],e[d]=_[2],e[v]=M=_[3],e[m]=O+"/"+M,e[p]=w[N],i.call(n,e)):P[N]=Object.getOwnPropertyDescriptor(w,N)}Object.defineProperties(D,P),T=t.call(x),b=t.call(n);for(L=0;L<b;L++)e=n[L],O=e[h],M=e[v],N=e[m],O=O in n?n[O]:n[O]=[],M=M in O?O[M]:O[M]=n[N]=[],O[O[u]]=M[M[u]]=e;return P={},P[o]={value:D},P[l]={value:x},P[c]={value:n},P[a]={value:y},Object.defineProperties(H,P),H}var n=Array.prototype,r=n.push,i=n.unshift,s=typeof function(){},o="prototype",u="length",a="extend",f="constructor",l="constructors",c="specials",h="group",p="value",d="features",v="type",m="name",g=/^(\w+)(?::([^\/]+))?\/(.+)/;return b}),function(e){e("when/when",[],function(){function r(e,t,n,r){return i(e).then(t,n,r)}function i(e){var t,n;return e instanceof o?t=e:l(e)?(n=f(),e.then(function(e){n.resolve(e)},function(e){n.reject(e)},function(e){n.progress(e)}),t=n.promise):t=u(e),t}function s(e){return r(e,a)}function o(e){this.then=e}function u(e){var t=new o(function(t){try{return i(t?t(e):e)}catch(n){return a(n)}});return t}function a(e){var t=new o(function(t,n){try{return n?i(n(e)):a(e)}catch(r){return a(r)}});return t}function f(){function h(e,t,n){return u(e,t,n)}function p(e){return c(e)}function d(e){return c(a(e))}function v(e){return l(e)}var e,t,r,s,u,l,c;return t=new o(h),e={then:h,resolve:p,reject:d,progress:v,promise:t,resolver:{resolve:p,reject:d,progress:v}},r=[],s=[],u=function(e,t,n){var i,o;return i=f(),o=typeof n=="function"?function(e){try{i.progress(n(e))}catch(t){i.progress(t)}}:function(e){i.progress(e)},r.push(function(n){n.then(e,t).then(i.resolve,i.reject,o)}),s.push(o),i.promise},l=function(e){return y(s,e),e},c=function(e){return e=i(e),u=e.then,c=i,l=w,y(r,e),s=r=n,e},e}function l(e){return e&&typeof e.then=="function"}function c(e,t,n,i,s){return b(2,arguments),r(e,function(e){function g(e){p(e)}function y(e){h(e)}var o,u,a,l,c,h,p,d,v,m;v=e.length>>>0,o=Math.max(0,Math.min(t,v)),a=[],u=v-o+1,l=[],c=f();if(!o)c.resolve(a);else{d=c.progress,p=function(e){l.push(e),--u||(h=p=w,c.reject(l))},h=function(e){a.push(e),--o||(h=p=w,c.resolve(a))};for(m=0;m<v;++m)m in e&&r(e[m],y,g,d)}return c.then(n,i,s)})}function h(e,t,n,r){function i(e){return t?t(e[0]):e[0]}return c(e,1,i,n,r)}function p(e,t,n,r){return b(1,arguments),v(e,E).then(t,n,r)}function d(){return v(arguments,E)}function v(e,t){return r(e,function(e){var n,i,s,o,u,a;s=i=e.length>>>0,n=[],a=f();if(!s)a.resolve(n);else{o=function(i,o){r(i,t).then(function(e){n[o]=e,--s||a.resolve(n)},a.reject)};for(u=0;u<i;u++)u in e?o(e[u],u):--s}return a.promise})}function m(n,i){var s=t.call(arguments,1);return r(n,function(t){var n;return n=t.length,s[0]=function(e,t,s){return r(e,function(e){return r(t,function(t){return i(e,t,s,n)})})},e.apply(t,s)})}function g(e,t,n){var i=arguments.length>2;return r(e,function(e){return e=i?n:e,t.resolve(e),e},function(e){return t.reject(e),a(e)},t.progress)}function y(e,t){var n,r=0;while(n=e[r++])n(t)}function b(e,t){var n,r=t.length;while(r>e){n=t[--r];if(n!=null&&typeof n!="function")throw new Error("arg "+r+" must be a function")}}function w(){}function E(e){return e}var e,t,n;return r.defer=f,r.resolve=i,r.reject=s,r.join=d,r.all=p,r.map=v,r.reduce=m,r.any=h,r.some=c,r.chain=g,r.isPromise=l,o.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(n,e)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return p(t,function(t){return e.apply(n,t)})})}},t=[].slice,e=[].reduce||function(e){var t,n,r,i,s;s=0,t=Object(this),i=t.length>>>0,n=arguments;if(n.length<=1)for(;;){if(s in t){r=t[s++];break}if(++s>=i)throw new TypeError}else r=n[1];for(;s<i;++s)s in t&&(r=e(r,t[s],s,t));return r},r})}(typeof define=="function"&&define.amd?define:function(e){typeof exports=="object"?module.exports=e():this.when=e()}),function(e){e("when/debug",["./when"],function(e){function u(t,n,r,i){var s=[t].concat(p(t,[n,r,i]));return a(e.apply(null,s),e.resolve(t))}function a(e,n){var r,s,o,u;return i.call(e,"parent")?e:(t++,r=n&&"id"in n?n.id+"."+t:t,s=e.then,o=E(e),o.id=r,o.parent=n,o.toString=function(){return v("Promise",r)},o.then=function(t,n,r){y(t,n,r);if(typeof n=="function"){var i=o;do i.handled=!0;while((i=i.parent)&&!i.handled)}return a(s.apply(e,p(o,arguments)),o)},u=function(){console.error(o.toString())},e.then(function(e){return o.toString=function(){return v("Promise",r,"resolved",e)},e},h(o,function(e){throw o.toString=function(){return v("Promise",r,"REJECTED",e)},d("reject",o,e),o.handled||u(),e})),o)}function f(){var r,i,s,u,f,l,c,h;return r=e.defer(),i="pending",s=n,h=arguments[arguments.length-1],h===o&&(h=++t),c=r.promise.then,r.id=h,r.promise=a(r.promise,r),r.resolver=E(r.resolver),r.resolver.toString=function(){return v("Resolver",h,i,s)},l=r.resolver.progress,r.progress=r.resolver.progress=function(e){return d("progress",r,e),l(e)},u=r.resolver.resolve,r.resolve=r.resolver.resolve=function(e){return s=e,i="resolving",d("resolve",r,e),u.apply(o,arguments)},f=r.resolver.reject,r.reject=r.resolver.reject=function(e){return s=e,i="REJECTING",f.apply(o,arguments)},r.toString=function(){return v("Deferred",h,i,s)},c(function(e){return i="resolved",e},function(t){return i="REJECTED",e.reject(t)}),r.then=g("deferred.then","deferred.promise.then",r.promise.then,r),r.resolver.id=h,r}function c(t,n){u[t]=function(){return a(n.apply(e,arguments))}}function h(e,t){return function(n){try{return t(n)}catch(i){if(i){var s=u.debug&&u.debug.exceptionsToRethrow||r;i.name in s&&m(i),d("reject",e,i)}throw i}}}function p(e,t){var n,r,i,s;r=[];for(s=0,i=t.length;s<i;s++)r[s]=typeof (n=t[s])=="function"?h(e,n):n;return r}function d(e,t,n,r){var i=u.debug;if(!i||typeof i[e]!="function")return;if(arguments.length<4&&e=="reject")try{throw new Error(t.toString())}catch(s){r=s}try{i[e](t,n,r)}catch(o){m(new Error("when.js global debug handler threw: "+String(o)))}}function v(e,t,r,i){var s="[object "+e+" "+t+"]";return arguments.length>2&&(s+=" "+r,i!==n&&(s+=": "+i)),s}function m(e){setTimeout(function(){throw e},0)}function g(e,t,n,r){return function(){return s((new Error(e+" is deprecated, use "+t)).stack),n.apply(r,arguments)}}function y(){var e,t,n;for(e=0,t=arguments.length;e<t;e++)n=arguments[e],b(n)||s((new Error("arg "+e+" must be a function, null, or undefined, but was a "+typeof n)).stack)}function b(e){return typeof e=="function"||e==null}function w(){}function E(e){return w.prototype=e,e=new w,w.prototype=o,e}var t,n,r,i,s,o;t=0,n={},i=Object.prototype.hasOwnProperty,s=typeof console!="undefined"&&typeof console.warn=="function"?function(e){console.warn(e)}:function(){},r={RangeError:1,ReferenceError:1,SyntaxError:1,TypeError:1},u.defer=f,u.isPromise=e.isPromise;for(var l in e)e.hasOwnProperty(l)&&!(l in u)&&c(l,e[l]);return u})}(typeof define=="function"?define:function(e,t){typeof module!="undefined"?module.exports=t(require("./when")):this.when=t(this.when)}),define("when",["when/debug"],function(e){return e}),define("troopjs-core/component/base",["../component/factory","when"],function(t,n){var r=Array.prototype,i=r.push,s=r.slice,o="instanceCount",u="length",a="value",f=0;return t(function(){this[o]=++f},{instanceCount:f,displayName:"core/component/base",signal:function(t){function c(e){return l=e||l,o>f?n(i[f++][a].apply(r,l),c):n.resolve(l)}var r=this,i=r.constructor.specials.sig[t],o=i?i[u]:0,f=0,l;try{return c(s.call(arguments))}catch(h){return n.reject(h)}},start:function(){var t=this,n=t.signal,r=["initialize"];return i.apply(r,arguments),n.apply(t,r).then(function(r){return r[0]="start",n.apply(t,r)})},stop:function(){var t=this,n=t.signal,r=["stop"];return i.apply(r,arguments),n.apply(t,r).then(function(){return r[0]="finalize",n.apply(t,r)})},toString:function(){var t=this;return t.displayName+"@"+t[o]}})}),define("troopjs-core/event/emitter",["../component/base","when"],function(t,n){var r="memory",i="context",s="callback",o="length",u="head",a="tail",f="next",l="handled",c="handlers";return t.extend(function(){this[c]={}},{displayName:"core/event/emitter",on:function(t,n,r){var h=this,p=arguments,d=h[c],v,m,g,y=p[o],b=2;if(t in d){d=d[t],v={},v[s]=p[b++],v[i]=n,g=a in d?d[a][f]=v:d[u]=v;while(b<y)g=g[f]=v={},v[s]=p[b++],v[i]=n;d[a]=g}else{m=g=v={},v[s]=p[b++],v[i]=n;while(b<y)g=g[f]=v={},v[s]=p[b++],v[i]=n;d=d[t]={},d[u]=m,d[a]=g,d[l]=0}return h},off:function(t,n,r){var l=this,h=arguments,p=l[c],d,v,m,g=h[o],y;if(t in p){p=p[t];if(u in p){d=p[u];e:do{if(d[i]===n){if(g===2)continue;for(y=2;y<g;y++)if(d[s]===h[y])continue e}v?m=m[f]=d:v=m=d}while(d=d[f]);return v&&m?(p[u]=v,p[a]=m,delete m[f]):(delete p[u],delete p[a]),l}return l}return l},reemit:function(t,a,h){var p=this,d=arguments,v=p[c],m,g,y=d[o],b;if(t in v){v=v[t];if(r in v){if(u in v){m=v[u],g=v[l]+1;e:do{if(m[i]===a){if(y===2)continue;for(b=2;b<y;b++)if(m[s]===d[b])continue e}m[l]=g}while(m=m[f]);return p.emit.apply(p,v[r])}return n.resolve(v[r])}}return n.resolve()},emit:function(t){function v(e){a=e||a;while(p[l]===d)if(!(p=p[f]))return h[r]=a,n.resolve(a);return p[l]=d,n(p[s].apply(p[i],a),v)}var o=this,a=arguments,h=o[c],p,d;if(t in h){h=h[t],d=++h[l];if(u in h){p=h[u];try{return v(a)}catch(m){return n.reject(m)}}}else h[t]=h={},h[l]=0;return h[r]=a,n.resolve(a)}})}),define("troopjs-core/pubsub/hub",["../event/emitter"],function(t){var n=t.prototype;return t.extend({displayName:"core/pubsub/hub",subscribe:n.on,unsubscribe:n.off,publish:n.emit,republish:n.reemit})()}),define("troopjs-core/component/gadget",["../event/emitter","when","../pubsub/hub"],function(t,n,r){var i=Array.prototype.push,s=r.publish,o=r.republish,u=r.subscribe,a=r.unsubscribe,f="length",l="features",c="type",h="value",p="subscriptions";return t.extend(function(){this[p]=[]},{displayName:"core/component/gadget","sig/initialize":function(){var t=this,n,i=t[p],s,o=t.constructor.specials.hub,a,d,v,m;for(a=0,d=o?o[f]:0;a<d;a++)s=o[a],n=i[a]={},n[c]=v=s[c],n[l]=s[l],n[h]=m=s[h],u.call(r,v,t,m)},"sig/start":function(){var t=this,i,s=t[p],u=[],a=0,d,v,m=n.defer();for(d=0,v=s[f];d<v;d++){i=s[d];if(i[l]!=="memory")continue;u[a++]=o.call(r,i[c],t,i[h])}return n.chain(u,m.resolver,arguments),m.promise},"sig/finalize":function(){var t=this,n,i=t[p],s,o;for(s=0,o=i[f];s<o;s++)n=i[s],a.call(r,n[c],t,n[h])},publish:function(){return s.apply(r,arguments)},subscribe:function(){var t=this,n=[t];return i.call(n,arguments),u.apply(r,n),t},unsubscribe:function(){var t=this,n=[t];return i.call(n,arguments),a.apply(r,n),t}})}),define("troopjs-core/component/service",["./gadget"],function(t){return t.extend({displayName:"core/component/service"})}),define("troopjs-utils/merge",[],function(){var t=Array,n=Object;return function r(e){var i=this,s=null,o,u,a,f;for(o=0,u=arguments.length;o<u;o++){e=arguments[o];for(s in e)a=e[s],f=a.constructor,s in i?f===t?i[s]=i[s].concat(a):f===n?r.call(i[s],a):i[s]=a:i[s]=a}return i}}),define("troopjs-browser/ajax/service",["troopjs-core/component/service","jquery","troopjs-utils/merge"],function(t,n,r){var i="trace",s=typeof function(){};return t.extend({displayName:"browser/ajax/service","hub/ajax":function(t,o){return n.ajax(r.call({headers:{"x-request-id":(new Date).getTime(),"x-components":typeof t[i]===s?t[i]():t}},o))}})}),define("troopjs-utils/getargs",[],function(){var t=Array.prototype.push,n=String.prototype.substring,r=/^(?:false|true)$/i,i=/^true$/i,s=/^\d+$/;return function(){var o=this,u=[],a,f,l,c,h,p,d=!1;for(f=l=c=0,a=o.length;c<a;c++){h=o.charAt(c);switch(h){case'"':case"'":d===h?(d=!1,t.call(u,n.call(o,f,l))):d=h,f=l=c+1;break;case",":if(d){l=c+1;break}f!==l&&(p=n.call(o,f,l),r.test(p)?p=i.test(p):s.test(p)&&(p=+p),t.call(u,p)),f=l=c+1;break;case" ":case"	":if(d){l=c+1;break}f===l&&(f=l=c+1);break;default:l=c+1}}return f!==l&&(p=n.call(o,f,l),r.test(p)?p=i.test(p):s.test(p)&&(p=+p),t.call(u,p)),u}}),define("troopjs-jquery/destroy",["jquery"],function(t){t.event.special.destroy={remove:function(n){var r=this;n.handler.call(r,t.Event({type:n.type,data:n.data,namespace:n.namespace,target:r}))}}}),define("troopjs-jquery/weave",["require","jquery","when","troopjs-utils/getargs","./destroy"],function(t,n,r,i){function b(){n(this).unweave()}var s,o=null,u=Array.prototype,a=u.slice,f="weave",l="unweave",c="woven",h="destroy",p="length",d="data-",v=d+f,m=d+c,g="["+v+"]",y="["+m+"]";n.expr[":"][f]=n.expr.createPseudo?n.expr.createPseudo(function(e){return e!==s&&(e=RegExp(n.map(i.call(e),function(e){return"^"+e+"$"}).join("|"),"m")),function(t){var r=n(t).attr(v);return r===s?!1:e===s?!0:e.test(r.split(/[\s,]+/).join("\n"))}}):function(e,t,r){var o=n(e).attr(v);return o===s?!1:r===s?!0:RegExp(n.map(i.call(r[3]),function(e){return"^"+e+"$"}).join("|"),"m").test(o.split(/[\s,]+/).join("\n"))},n.expr[":"][c]=n.expr.createPseudo?n.expr.createPseudo(function(e){return e!==s&&(e=RegExp(n.map(i.call(e),function(e){return"^"+e+"@\\d+"}).join("|"),"m")),function(t){var r=n(t).attr(m);return r===s?!1:e===s?!0:e.test(r.split(/[\s,]+/).join("\n"))}}):function(e,t,r){var o=n(e).attr(m);return o===s?!1:r===s?!0:RegExp(n.map(i.call(r[3]),function(e){return"^"+e+"@\\d+"}).join("|"),"m").test(o.split(/[\s,]+/).join("\n"))},n.fn[f]=function(){var e=n(this),s=a.call(arguments),l=[],d=0;return e.filter(g).each(function(e,a){var g=n(a),y=g.data(),w=y[f]=g.attr(v)||"";g.removeAttr(v),r(y[c]).then(function(){var e=/[\s,]*([\w_\-\/\.]+)(?:\(([^\)]+)\))?/g,n,a,f=[],v=0,E,S,x;while((n=e.exec(w))!==o){a=i.call(n[2]);for(E=0,S=a[p];E<S;E++)x=a[E],a[E]=x in y?y[x]:x;f[v++]=u.concat(g,n[1],a)}l[d++]=y[c]=r.map(f,function(e){var n=r.defer(),i=n.resolver;return t([e[1]],function(t){var n;try{n=t.apply(t,e),r.chain(n.start.apply(n,s),i,n)}catch(o){i.reject(o)}},i.reject),n.promise}).then(function(e){return g.attr(m,e.join(" ")).on(h,b),e})})}),r.all(l)},n.fn[l]=function(){var e=n(this),t=a.call(arguments),i=[],s=0;return e.filter(y).each(function(e,o){var u=n(o),a=u.data();u.removeAttr(m),i[s++]=a[c]=r.map(a[c],function(e){var n=r.defer();return r.chain(e.stop.apply(e,t),n.resolver,e),n.promise}).then(function(e){return u.attr(v,a[f]).off(h,b),e})}),r.all(i)},n.fn[c]=function(){var e=[],t=0,i=arguments[p]>0?RegExp(n.map(arguments,function(e){return"^"+e+"$"}).join("|"),"m"):s;return n(this).each(function(o,u){e[t++]=i===s?n.data(u,c):r(n.data(u,c),function(e){return n.grep(e,function(e){return i.test(e.displayName)})})}),r.all(e)}}),define("troopjs-jquery/action",["jquery","troopjs-utils/getargs"],function(t,n){function c(e,t){return e?e+"."+u:s}function h(e){var n=t(this),r=o.call(arguments,1),s=a in e?e[a].type:u,f=e[u];e.type=u+"/"+f+"."+s,n.trigger(e,r),e.result!==i&&(e.type=u+"/"+f+"!",n.trigger(e,r),e.result!==i&&(e.type=u+"."+s,n.trigger(e,r)))}function p(e){var i=t(e.target).closest("[data-action]");if(i.length===0)return;var o=i.data(),a=f.exec(o[u]);if(a===s)return;var c=a[1],h=a[2],p=a[3];if(h!==r&&!RegExp(h.split(l).join("|")).test(e.type))return;var d=p!==r?n.call(p):[];t.each(d,function(t,n){n in o&&(d[t]=o[n])}),i.trigger(t.Event(e,{type:u+"!",action:c}),d),e.stopPropagation()}var r,i=!1,s=null,o=Array.prototype.slice,u="action",a="originalEvent",f=/^([\w\d\s_\-\/]+)(?:\.([\w\.]+))?(?:\((.*)\))?$/,l=/\.+/;t.event.special[u]={setup:function(n,r,i){t(this).bind(u,n,h)},add:function(n){var r=t.map(n.namespace.split(l),c);r.length!==0&&t(this).bind(r.join(" "),p)},remove:function(n){var r=t.map(n.namespace.split(l),c);r.length!==0&&t(this).unbind(r.join(" "),p)},teardown:function(n){t(this).unbind(u,h)}},t.fn[u]=function(n){return t(this).trigger({type:u+"!",action:n},o.call(arguments,1))}}),define("troopjs-browser/component/widget",["troopjs-core/component/gadget","jquery","troopjs-jquery/weave","troopjs-jquery/action"],function(t,n){function E(e,t,n){return function(){var i=[e];return o.apply(i,arguments),n.apply(t,i)}}function S(e){function t(t,n){var r=this,i=s.call(arguments,1);return e.call(r[p],typeof t===u?t.apply(r,i):t),r.weave()}return t}var r,i=Array.prototype,s=i.slice,o=i.push,u=typeof function(){},a=n.fn.trigger,f=n.fn.on,l=n.fn.off,c=n.fn.weave,h=n.fn.unweave,p="$element",d="$handlers",v="[data-weave]",m="[data-woven]",g="length",y="features",b="type",w="value";return t.extend(function(t,n){var i=this;if(t===r)throw new Error("No $element provided");i[p]=t,i[d]=[],n!==r&&(i.displayName=n)},{displayName:"browser/component/widget","sig/initialize":function(){var t=this,n=t[p],r,i=t[d],s,o=t.constructor.specials.dom,u,a,l,c,h;for(c=0,h=o?o[g]:0;c<h;c++)s=o[c],r=i[c]={},r[b]=u=s[b],r[y]=a=s[y],r[w]=l=E(u,t,s[w]),f.call(n,u,a,t,l)},"sig/finalize":function(){var t=this,n=t[p],r,i=t[d],s,o;for(s=0,o=i[g];s<o;s++)r=i[s],l.call(n,r[b],r[y],r[w]);delete t[p]},weave:function(){return c.apply(this[p].find(v),arguments)},unweave:function(){return h.apply(this[p].find(m).addBack(),arguments)},$on:function(){var t=this;return f.apply(t[p],arguments),t},$off:function(){var t=this;return l.apply(t[p],arguments),t},$emit:function(){var t=this;return a.apply(t[p],arguments),t},before:S(n.fn.before),after:S(n.fn.after),html:S(n.fn.html),text:S(n.fn.text),append:S(n.fn.append),prepend:S(n.fn.prepend)})}),define("troopjs-browser/application/widget",["module","../component/widget","when"],function(t,n,r){function o(){function f(e){return a=e||a,o>u?r(t.apply(n[u++],a),f):r.resolve(a)}var e=this,t=this.signal,n=e[i],o=n?n.length:0,u=0,a;return f(s.call(arguments))}var i="children",s=Array.prototype.slice;return n.extend(function(t,n,r){this[i]=r||[]},{displayName:"browser/application/widget","sig/initialize":o,"sig/start":function(){var t=this,n=t.weave,r=arguments;return o.apply(t,r).then(function(){return n.apply(t,s.call(r,1))})},"sig/stop":function(){var t=this,n=t.unweave,r=arguments;return n.apply(t,s.call(r,1)).then(function(){return o.apply(t,r)})},"sig/finalize":o})}),define("troopjs-jquery/dimensions",["jquery"],function(t){function f(e,t){return t-e}function l(e){var n=this,i=t(n),f=i.width(),l=i.height();t.each(t.data(n,r),function(t,n){var c=n[s],h=n[o],p,d,v;v=c.length,p=c[v-1];while(c[--v]<f)p=c[v];v=h.length,d=h[v-1];while(h[--v]<l)d=h[v];if(p!==n[u]||d!==n[a])n[u]=p,n[a]=d,i.trigger(r+"."+t,[p,d])})}var n=null,r="dimensions",i="resize."+r,s="w",o="h",u="_"+s,a="_"+o;t.event.special[r]={setup:function(n,s,o){t(this).bind(i,l).data(r,{})},add:function(i){var u=this,a=i.namespace,l={},c=l[s]=[],h=l[o]=[],p=/(w|h)(\d+)/g,d;while((d=p.exec(a))!==n)l[d[1]].push(parseInt(d[2],10));c.sort(f),h.sort(f),t.data(u,r)[a]=l},remove:function(n){delete t.data(this,r)[n.namespace]},teardown:function(n){t(this).removeData(r).unbind(i,l)}}}),define("troopjs-jquery/resize",["jquery"],function(t){function a(e,n){var o=t.data(n),u=t(n),a=u.width(),f=u.height();(a!==o[i]||f!==o[s])&&u.trigger(r,[o[i]=a,o[s]=f])}function f(){o.each(a)}var n=null,r="resize",i="w",s="h",o=t([]),u=n;t.event.special[r]={setup:function(n,a,l){var c=this;if(t.isWindow(c))return!1;var h=t.data(c,r,{}),p=t(c);h[i]=p.width(),h[s]=p.height(),o=o.add(c),o.length===1&&(u=setInterval(f,100))},teardown:function(i){var s=this;if(t.isWindow(s))return!1;t.removeData(s,r),o=o.not(s),o.length===0&&u!==n&&clearInterval(u)}}}),define("troopjs-browser/dimensions/widget",["../component/widget","troopjs-jquery/dimensions","troopjs-jquery/resize"],function(t){function i(e,t,n){var r=e.data;r.publish(r.displayName,t,n,e)}var n,r="dimensions";return t.extend(function(t,i,s){if(s===n)throw new Error("No dimensions provided");this[r]=s},{displayName:"browser/dimensions/widget","sig/initialize":function(){var t=this;t.$on(r+"."+t[r],t,i)},"sig/start":function(){this.$emit("resize."+r)},"sig/finalize":function(){var t=this;t.$off(r+"."+t[r],i)}})}),define("troopjs-browser/route/uri",["troopjs-core/component/factory"],function(t){function y(e){var t={},r,i=n,s,o=/(?:&|^)([^&=]*)=?([^&]*)/g;t.toString=y.toString;if(u.call(e)===a)for(i in e)t[i]=e[i];else while((r=o.exec(e))!==n)i=r[1],i in t?(s=t[i],u.call(s)===f?s[s.length]=r[2]:t[i]=[s,r[2]]):t[i]=r[2];return t}function b(e){var t=[];return t.toString=b.toString,s.apply(t,u.call(e)===f?e:o.call(e,"/")),t}var n=null,r=Array.prototype,i=Object.prototype,s=r.push,o=String.prototype.split,u=i.toString,a=u.call(i),f=u.call(r),l=u.call(Function.prototype),c=/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:([^?#]*)(?:\?([^#]*))?(?:#(.*))?)/,h="protocol",p="authority",d="path",v="query",m="anchor",g=["source",h,p,"userInfo","user","password","host","port",d,v,m];y.toString=function(){var t=this,n,r,i,s=[],o=0,a;for(n in t){if(u.call(t[n])===l)continue;s[o++]=n}s.sort();while(o--){n=s[o],r=t[n];if(u.call(r)===f){i=r.slice(0),i.sort(),a=i.length;while(a--)r=i[a],i[a]=r===""?n:n+"="+r;s[o]=i.join("&")}else s[o]=r===""?n:n+"="+r}return s.join("&")},b.toString=function(){return this.join("/")};var w=t(function(t){var r=this,i,s,o;if((s=c.exec(t))!==n){o=s.length;while(o--)i=s[o],i&&(r[g[o]]=i)}v in r&&(r[v]=y(r[v])),d in r&&(r[d]=b(r[d]))},{displayName:"browser/route/uri",toString:function(){var t=this,n=[h,"://",p,d,"?",v,"#",m],r,i;h in t||(n[0]=n[1]=""),p in t||(n[2]=""),d in t||(n[3]=""),v in t||(n[4]=n[5]=""),m in t||(n[6]=n[7]=""),r=n.length;while(r--)i=n[r],i in t&&(n[r]=t[i]);return n.join("")}});return w.Path=b,w.Query=y,w}),define("troopjs-jquery/hashchange",["jquery"],function(t){function a(e){var t=s.exec(e.location.href);return t&&t[1]?decodeURIComponent(t[1]):""}function f(e){var t=this,n;t.element=n=e.createElement("iframe"),n.src="about:blank",n.style.display="none"}var n="interval",r="hashchange",i="on"+r,s=/#(.*)$/,o=/\?/,u=0;f.prototype={getElement:function(){return this.element},getHash:function(){return this.element.contentWindow.frameHash},update:function(e){var t=this,n=t.element.contentWindow.document;if(t.getHash()===e)return;n.open(),n.write("<html><head><title>' + document.title + '</title><script type='text/javascript'>var frameHash='"+e+"';</script></head><body>&nbsp;</body></html>"),n.close()}},t.event.special[r]={setup:function(s,l,c){var h=this;if(i in h)return!1;if(!t.isWindow(h))throw new Error("Unable to bind 'hashchange' to a non-window object");var p=t(h),d=a(h),v=h.location;p.data(n,h.setInterval(u?function(){var e=h.document,t=v.protocol==="file:",n=new f(e);return e.body.appendChild(n.getElement()),n.update(d),function(){var e=d,i,s=a(h),u=n.getHash();u!==d&&u!==s?(i=decodeURIComponent(u),d!==i&&(d=i,n.update(d),p.trigger(r,[i,e])),v.hash="#"+encodeURI(t?u.replace(o,"%3F"):u)):s!==d&&(i=decodeURIComponent(s),d!==i&&(d=i,p.trigger(r,[i,e])))}}():function(){var e=d,t,n=a(h);n!==d&&(t=decodeURIComponent(n),d!==t&&(d=t,p.trigger(r,[t,e])))},25))},teardown:function(r){var s=this;if(i in s)return!1;s.clearInterval(t.data(s,n))}}}),define("troopjs-browser/route/widget",["../component/widget","./uri","troopjs-jquery/hashchange"],function(t,n){function o(e){var t=e.data,r=n(e.target.location.hash.replace(s,"")),o=r.toString();o!==t[i]&&(t[i]=o,t.publish(t.displayName,r,e))}var r="hashchange",i="route",s=/^#/;return t.extend({displayName:"browser/route/widget","sig/initialize":function(){var t=this;t.$on(r,t,o)},"sig/start":function(){this.$emit(r)},"sig/finalize":function(){this.$off(r,o)}})}),define("troopjs-browser/store/base",["troopjs-core/component/gadget","when"],function(t,n){var r="storage";return t.extend({displayName:"browser/store/base",set:function(t,i){return n(this[r].setItem(t,JSON.stringify(i)))},get:function(t){return n(JSON.parse(this[r].getItem(t)))},remove:function(t){return n(this[r].removeItem(t))},clear:function(){return n(this[r].clear())}})}),define("troopjs-browser/store/local",["./base"],function(t){return t.extend({displayName:"browser/store/local",storage:window.localStorage})()}),define("troopjs-browser/store/session",["./base"],function(t){return t.extend({displayName:"browser/store/session",storage:window.sessionStorage})()}),define("troopjs-core/pubsub/topic",["../component/base","troopjs-utils/unique"],function(t,n){function l(e,t){return e[f]===t[f]}var r=Object.prototype.toString,i=r.call(Array.prototype),s="topic",o="publisher",u="parent",a="constructor",f="publisherInstanceCount";return t.extend(function(t,n,r){var i=this;i[s]=t,i[o]=n,i[u]=r,i[f]=n.instanceCount},{displayName:"core/pubsub/topic",trace:function(){var t=this,f=t[a],c,h="",p,d,v;while(t){if(r.call(t)===i){n.call(t,l);for(p=0,v=t.length;p<v;p++)c=t[p],t[p]=c[a]===f?c.trace():c[s];h+=t.join(",");break}h+=u in t?t[o]+":":t[o],t=t[u]}return h},toString:function(){return this[s]}})}),define("troopjs-data/cache/component",["troopjs-core/component/base"],function(t){function E(e,t,u){var a=this,l,S,x,T,N,C,k,L,A,O,M=a[f],_,D;e:{if(!(m in e)){l=e;break e}S=e[m];if(S in a){l=a[S];break e}l=a[S]=e,l[b]=u}if(t===o)for(x=0,T=e[v];x<T;x++)D=e[x],t=D===i||D===n?n:D[d],l[x]=t===s||t===o&&D[v]!==0?E.call(a,D,t,u):D;else if(t===s)for(_ in e){if(_===m||_===w&&l[w]===r)continue;D=e[_],t=D===i||D===n?n:D[d],l[_]=t===s||t===o&&D[v]!==0?E.call(a,D,t,u):D}t:{if(S===i)break t;N=0|u+(l[g]>>>0);n:{if(!(y in l))break n;C=l[y];if(C===N)break t;C in M&&delete M[C][S]}r:{l[y]=N;if(N in M){M[N][S]=l;break r}(O=M[N]={})[p]=N,O[S]=l;if(M[c]===n){M[c]=O;break r}for(L=k=M[c];(A=L[h])!==n&&A[p]<N;L=A);if(L===k&&L[p]>N){O[h]=L,M[c]=O;break r}O[h]=L[h],L[h]=O}}return l}var n,r=!1,i=null,s=Object,o=Array,u=1e3,a="interval",f="generations",l="age",c="head",h="next",p="expires",d="constructor",v="length",m="id",g="maxAge",y="expires",b="indexed",w="collapsed";return t.extend(function(t){var n=this;n[l]=t||60*u,n[f]={}},{displayName:"data/cache/component","sig/start":function(){var t=this,r=t[f];t[a]=a in t?t[a]:setInterval(function(){var i=0|(new Date).getTime()/u,s,o;o=r[c];if(o===n)return;do{if(o[p]>i)break;for(s in o){if(s===p||s===h||s===f)continue;delete t[s]}delete r[o[p]]}while(o=o[h]);r[c]=o},t[l])},"sig/stop":function(){var t=this;a in t&&(clearInterval(t[a]),delete t[a])},"sig/finalize":function(){var t=this,n;for(n in t){if(!(t[n][d]===s&&m in t[n]))continue;delete t[n]}},put:function(t){var r=this,a=t===i||t===n?n:t[d];return a===s||a===o&&t[v]!==0?E.call(r,t,a,0|(new Date).getTime()/u):t}})}),define("troopjs-data/component/widget",["troopjs-browser/component/widget","troopjs-core/pubsub/topic"],function(t,n){var r=Array.prototype.push;return t.extend({displayName:"data/component/widget",query:function(){var t=this,i=[n("query",this)];return r.apply(i,arguments),t.publish.apply(t,i)}})}),define("troopjs-data/query/component",["troopjs-core/component/base"],function(t){var n,r=!0,i=!1,s=Object,o=Array,u="constructor",a="length",f="op",l="!",c=".",h=",",p="|",d="text",v="raw",m="resolved",g="id",y="expires",b="collapsed",w="_ast",E="_query",S=/("|')(.*?)\1/,x="$2",T=/!(.*[!,|.\s]+.*)/,N="!'$1'";return t.extend(function(t){var r=this;t!==n&&(r[E]=t)},{displayName:"data/query/component",parse:function(t){var r=this;delete r[w],t=r[E]=t||r[E]||"";var i,s,o,u,m,g,y=[];for(i=u=0,s=t[a];i<s;i++){o=t.charAt(i);switch(o){case'"':case"'":m=m===o?n:o;break;case l:if(m!==n)break;g={},g[f]=o;break;case c:case h:if(m!==n)break;g!==n&&(g[v]=(g[d]=t.substring(u,i)).replace(S,x),y.push(g)),g={},g[f]=o,u=i+1;break;case p:case" ":case"	":case"\r":case"\n":if(m!==n)break;g!==n&&(g[v]=(g[d]=t.substring(u,i)).replace(S,x),y.push(g)),g=n,u=i+1}}return g!==n&&(g[v]=(g[d]=t.substring(u,s)).replace(S,x),y.push(g)),r[w]=y,r},reduce:function(t){var p=this,E=0|(new Date).getTime()/1e3;w in p||p.parse();var S=p[w],x=[],C,k,L,A,O,M,_,D,P=i;for(C=0,A=S[a];C<A;C++){O=S[C];switch(O[f]){case l:_=O,M=O[v],M in t?(D=t[M],O[m]=D[b]!==r&&!(y in D)||D[y]>E):(D=n,O[m]=i);break;case c:M=O[v];if(D&&M in D){D=D[M],L=D[u];if(L===o){O[m]=r;for(k=D[a];k-->0;){L=D[k];if(L[u]===s&&g in L&&(L[b]===r||y in L)&&!(L[y]>E)){O[m]=i;break}continue}}else L===s&&g in D?(O[f]=l,O[d]=(O[v]=D[g]).replace(T,N),O[m]=D[b]!==r&&!(y in D)||D[y]>E):O[m]=r}else D=n,O[m]=i;break;case h:M=_[v],D=t[M],O[f]=l,O[d]=_[d],O[v]=M,O[m]=_[m]}}while(A-->0){O=S[A];switch(O[f]){case l:(P||O[m]!==r)&&x.unshift(O),P=i;break;case c:x.unshift(O),P=r}}return p[w]=x,p},ast:function(){var t=this;return w in t||t.parse(),t[w]},rewrite:function(){var t=this;w in t||t.parse();var n=t[w],r="",i,s,o;for(s=0,i=n[a];s<i;s++){o=n[s];switch(o[f]){case l:r+=s===0?o[d]:p+o[d];break;case c:r+=c+o[d]}}return r}})}),define("troopjs-data/query/service",["module","troopjs-core/component/service","./component","troopjs-core/pubsub/topic","when","troopjs-utils/merge"],function(t,n,r,i,s,o){var u,a=Array.prototype,f=a.slice,l=a.concat,c=a.push,h="length",p="batches",d="interval",v="cache",m="topic",g="queries",y="resolved",b="raw",w="id",E="q",S=t.config(),x=n.extend(function(t){var n=this;if(t===u)throw new Error("No cache provided");n[p]=[],n[v]=t},{displayName:"data/query/service","sig/start":function(){var t=this,n=t[v];t[d]=d in t?t[d]:setInterval(function(){function s(){var e=[],n=[],s,u;for(u=r[h];u--;)s=r[u],c.call(n,s[m]),c.apply(e,s[E]);return t.publish(i("ajax",t,n),o.call({data:{q:e.join("|")}},S))}function u(e){var t,i,s,o,u;n.put(e);for(o=r[h];o--;){t=r[o],i=t[g],s=t[w];for(u=i[h];u--;)u in s&&(i[u]=n[s[u]]);t.resolve(i)}}function a(){var e,t;for(t=r[h];t--;)e=r[t],e.reject(e[g])}var r=t[p];if(r[h]===0)return;return t[p]=[],s().then(u,a)},200)},"sig/stop":function(){var t=this;d in t&&(clearInterval(t[d]),delete t[d])},"hub/query":function(t){var n=this,i=n[p],o=n[v],u=[],d=[],S,x,T,N,C,k,L=s.defer();try{C=l.apply(a,f.call(arguments,1));for(x=0,N=C[h];x<N;x++){k=r(C[x]),S=k.ast(),S[h]>0&&(d[x]=S[0][b]),S=k.reduce(o).ast();for(T=S[h];T-->0;)if(!S[T][y]){c.call(u,k.rewrite());break}}if(u[h]===0){for(x=0;x<N;x++)x in d&&(C[x]=o[d[x]]);L.resolve(C)}else L[m]=t,L[g]=C,L[w]=d,L[E]=u,i.push(L)}catch(A){L.reject(A)}return L.promise}});return x.config=function(t){return o.call(S,t)},x}),define("troopjs-requirejs/template",[],function(){function f(e){function l(e,n,r){return t[f]=n?'" +'+r+'+ "':'";'+r+'o += "',"<%"+String(f++)+"%>"}function c(e,n){return t[n]}function h(e,t){return a[t]||t}var t=[],f=0;return('function template(data) { var o = "'+e.replace(n,"").replace(r,l).replace(s,h).replace(i,c)+'"; return o; }').replace(o,u)}var t={node:function(){var e=require.nodeRequire("fs");return function(n,r){var i=e.readFileSync(n,"utf8");i.indexOf("﻿")===0&&(i=i.substring(1)),r(i)}},browser:function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t,n,r;if(typeof XMLHttpRequest!="undefined")n=XMLHttpRequest;else{for(r=0;r<3;r++){t=e[r];try{new ActiveXObject(t),n=function(){return new ActiveXObject(t)};break}catch(i){}}if(!n)throw new Error("XHR: XMLHttpRequest not available")}return function(t,r){var i=new n;i.open("GET",t,!0),i.onreadystatechange=function(e){i.readyState===4&&r(i.responseText)},i.send(null)}},rhino:function(){var e="utf-8",t=java.lang.System.getProperty("line.separator");return function(r,i){var s=new java.io.File(r),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),e)),u=new java.lang.StringBuffer,a,f="";try{a=o.readLine(),a&&a.length()&&a.charAt(0)===65279&&(a=a.substring(1)),u.append(a);while((a=o.readLine())!==null)u.append(t),u.append(a);f=String(u.toString())}finally{o.close()}i(f)}},borked:function(){return function(){throw new Error("Environment unsupported.")}}},n=/^[\n\t\r]+|[\n\t\r]+$/g,r=/<%(=)?([\S\s]*?)%>/g,i=/<%(\d+)%>/gm,s=/(["\n\t\r])/gm,o=/o \+= "";| \+ ""/gm,u="",a={'"':'\\"',"\n":"\\n","	":"\\t","\r":"\\r"},l={},c=t[typeof process!="undefined"&&process.versions&&!!process.versions.node?"node":typeof window!="undefined"&&window.navigator&&window.document||typeof importScripts!="undefined"?"browser":typeof Packages!="undefined"?"rhino":"borked"]();return{load:function(e,t,n,r){var i=t.toUrl(e);c(i,function(s){try{s="define(function() { return "+f(s,e,i,r.template)+"; })"}catch(o){throw o.message="In "+i+", "+o.message,o}r.isBuild?l[e]=s:s+="\n//@ sourceURL='"+i+"'",n.fromText(e,s),t([e],function(e){n(e)})})},write:function(e,t,n){l.hasOwnProperty(t)&&n.asModule(e+"!"+t,l[t])}}}),define("troopjs-utils/tr",[],function(){var t=typeof Number();return function(n){var r=this,i=[],s,o=r.length,u;if(typeof o===t&&o===0||o>0&&0 in r&&o-1 in r)for(s=0;s<o;s++)i.push(n.call(r,r[s],s));else if(r)for(u in r)i.push(n.call(r,r[u],u));return i}});